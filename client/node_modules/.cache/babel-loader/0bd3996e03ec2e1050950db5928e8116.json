{"ast":null,"code":"'use strict'; // tar -u\n\nvar hlo = require('./high-level-opt.js');\n\nvar r = require('./replace.js'); // just call tar.r with the filter and mtimeCache\n\n\nvar u = module.exports = function (opt_, files, cb) {\n  var opt = hlo(opt_);\n  if (!opt.file) throw new TypeError('file is required');\n  if (opt.gzip) throw new TypeError('cannot append to compressed archives');\n  if (!files || !Array.isArray(files) || !files.length) throw new TypeError('no files or directories specified');\n  files = Array.from(files);\n  mtimeFilter(opt);\n  return r(opt, files, cb);\n};\n\nvar mtimeFilter = function mtimeFilter(opt) {\n  var filter = opt.filter;\n  if (!opt.mtimeCache) opt.mtimeCache = new Map();\n  opt.filter = filter ? function (path, stat) {\n    return filter(path, stat) && !(opt.mtimeCache.get(path) > stat.mtime);\n  } : function (path, stat) {\n    return !(opt.mtimeCache.get(path) > stat.mtime);\n  };\n};","map":null,"metadata":{},"sourceType":"script"}