{"ast":null,"code":"import * as tf from '@tensorflow/tfjs-core';\nimport { convLayer } from '../common';\nimport { fullyConnectedLayer } from '../common/fullyConnectedLayer';\nimport { prelu } from './prelu';\nimport { sharedLayer } from './sharedLayers';\nexport function ONet(x, params) {\n  return tf.tidy(function () {\n    var out = sharedLayer(x, params);\n    out = tf.maxPool(out, [2, 2], [2, 2], 'same');\n    out = convLayer(out, params.conv4, 'valid');\n    out = prelu(out, params.prelu4_alpha);\n    var vectorized = tf.reshape(out, [out.shape[0], params.fc1.weights.shape[0]]);\n    var fc1 = fullyConnectedLayer(vectorized, params.fc1);\n    var prelu5 = prelu(fc1, params.prelu5_alpha);\n    var fc2_1 = fullyConnectedLayer(prelu5, params.fc2_1);\n    var max = tf.expandDims(tf.max(fc2_1, 1), 1);\n    var prob = tf.softmax(tf.sub(fc2_1, max), 1);\n    var regions = fullyConnectedLayer(prelu5, params.fc2_2);\n    var points = fullyConnectedLayer(prelu5, params.fc2_3);\n    var scores = tf.unstack(prob, 1)[1];\n    return {\n      scores: scores,\n      regions: regions,\n      points: points\n    };\n  });\n}","map":{"version":3,"sources":["../../../src/mtcnn/ONet.ts"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAZ,MAAoB,uBAApB;AAEA,SAAS,SAAT,QAA0B,WAA1B;AACA,SAAS,mBAAT,QAAoC,+BAApC;AACA,SAAS,KAAT,QAAsB,SAAtB;AACA,SAAS,WAAT,QAA4B,gBAA5B;AAGA,OAAM,SAAU,IAAV,CAAe,CAAf,EAA+B,MAA/B,EAAiD;AACrD,SAAO,EAAE,CAAC,IAAH,CAAQ,YAAA;AAEb,QAAI,GAAG,GAAG,WAAW,CAAC,CAAD,EAAI,MAAJ,CAArB;AACA,IAAA,GAAG,GAAG,EAAE,CAAC,OAAH,CAAW,GAAX,EAAgB,CAAC,CAAD,EAAI,CAAJ,CAAhB,EAAwB,CAAC,CAAD,EAAI,CAAJ,CAAxB,EAAgC,MAAhC,CAAN;AACA,IAAA,GAAG,GAAG,SAAS,CAAC,GAAD,EAAM,MAAM,CAAC,KAAb,EAAoB,OAApB,CAAf;AACA,IAAA,GAAG,GAAG,KAAK,CAAc,GAAd,EAAmB,MAAM,CAAC,YAA1B,CAAX;AAEA,QAAM,UAAU,GAAG,EAAE,CAAC,OAAH,CAAW,GAAX,EAAgB,CAAC,GAAG,CAAC,KAAJ,CAAU,CAAV,CAAD,EAAe,MAAM,CAAC,GAAP,CAAW,OAAX,CAAmB,KAAnB,CAAyB,CAAzB,CAAf,CAAhB,CAAnB;AACA,QAAM,GAAG,GAAG,mBAAmB,CAAC,UAAD,EAAa,MAAM,CAAC,GAApB,CAA/B;AACA,QAAM,MAAM,GAAG,KAAK,CAAc,GAAd,EAAmB,MAAM,CAAC,YAA1B,CAApB;AACA,QAAM,KAAK,GAAG,mBAAmB,CAAC,MAAD,EAAS,MAAM,CAAC,KAAhB,CAAjC;AACA,QAAM,GAAG,GAAG,EAAE,CAAC,UAAH,CAAc,EAAE,CAAC,GAAH,CAAO,KAAP,EAAc,CAAd,CAAd,EAAgC,CAAhC,CAAZ;AAEA,QAAM,IAAI,GAAG,EAAE,CAAC,OAAH,CAAW,EAAE,CAAC,GAAH,CAAO,KAAP,EAAc,GAAd,CAAX,EAA+B,CAA/B,CAAb;AACA,QAAM,OAAO,GAAG,mBAAmB,CAAC,MAAD,EAAS,MAAM,CAAC,KAAhB,CAAnC;AACA,QAAM,MAAM,GAAG,mBAAmB,CAAC,MAAD,EAAS,MAAM,CAAC,KAAhB,CAAlC;AAEA,QAAM,MAAM,GAAG,EAAE,CAAC,OAAH,CAAW,IAAX,EAAiB,CAAjB,EAAoB,CAApB,CAAf;AACA,WAAO;AAAE,MAAA,MAAM,EAAA,MAAR;AAAU,MAAA,OAAO,EAAA,OAAjB;AAAmB,MAAA,MAAM,EAAA;AAAzB,KAAP;AACD,GAnBM,CAAP;AAoBD","sourceRoot":"","sourcesContent":["import * as tf from '@tensorflow/tfjs-core';\r\nimport { convLayer } from '../common';\r\nimport { fullyConnectedLayer } from '../common/fullyConnectedLayer';\r\nimport { prelu } from './prelu';\r\nimport { sharedLayer } from './sharedLayers';\r\nexport function ONet(x, params) {\r\n    return tf.tidy(function () {\r\n        var out = sharedLayer(x, params);\r\n        out = tf.maxPool(out, [2, 2], [2, 2], 'same');\r\n        out = convLayer(out, params.conv4, 'valid');\r\n        out = prelu(out, params.prelu4_alpha);\r\n        var vectorized = tf.reshape(out, [out.shape[0], params.fc1.weights.shape[0]]);\r\n        var fc1 = fullyConnectedLayer(vectorized, params.fc1);\r\n        var prelu5 = prelu(fc1, params.prelu5_alpha);\r\n        var fc2_1 = fullyConnectedLayer(prelu5, params.fc2_1);\r\n        var max = tf.expandDims(tf.max(fc2_1, 1), 1);\r\n        var prob = tf.softmax(tf.sub(fc2_1, max), 1);\r\n        var regions = fullyConnectedLayer(prelu5, params.fc2_2);\r\n        var points = fullyConnectedLayer(prelu5, params.fc2_3);\r\n        var scores = tf.unstack(prob, 1)[1];\r\n        return { scores: scores, regions: regions, points: points };\r\n    });\r\n}\r\n//# sourceMappingURL=ONet.js.map"]},"metadata":{},"sourceType":"module"}