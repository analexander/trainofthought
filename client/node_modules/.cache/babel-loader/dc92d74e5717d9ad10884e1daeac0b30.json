{"ast":null,"code":"import { iou } from './iou';\nexport function nonMaxSuppression(boxes, scores, iouThreshold, isIOU) {\n  if (isIOU === void 0) {\n    isIOU = true;\n  }\n\n  var indicesSortedByScore = scores.map(function (score, boxIndex) {\n    return {\n      score: score,\n      boxIndex: boxIndex\n    };\n  }).sort(function (c1, c2) {\n    return c1.score - c2.score;\n  }).map(function (c) {\n    return c.boxIndex;\n  });\n  var pick = [];\n\n  var _loop_1 = function _loop_1() {\n    var curr = indicesSortedByScore.pop();\n    pick.push(curr);\n    var indices = indicesSortedByScore;\n    var outputs = [];\n\n    for (var i = 0; i < indices.length; i++) {\n      var idx = indices[i];\n      var currBox = boxes[curr];\n      var idxBox = boxes[idx];\n      outputs.push(iou(currBox, idxBox, isIOU));\n    }\n\n    indicesSortedByScore = indicesSortedByScore.filter(function (_, j) {\n      return outputs[j] <= iouThreshold;\n    });\n  };\n\n  while (indicesSortedByScore.length > 0) {\n    _loop_1();\n  }\n\n  return pick;\n}","map":{"version":3,"sources":["../../../src/ops/nonMaxSuppression.ts"],"names":[],"mappings":"AACA,SAAS,GAAT,QAAoB,OAApB;AAEA,OAAM,SAAU,iBAAV,CACJ,KADI,EAEJ,MAFI,EAGJ,YAHI,EAIJ,KAJI,EAIiB;AAArB,MAAA,KAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,KAAA,GAAA,IAAA;AAAqB;;AAGrB,MAAI,oBAAoB,GAAG,MAAM,CAC9B,GADwB,CACpB,UAAC,KAAD,EAAQ,QAAR,EAAgB;AAAK,WAAC;AAAE,MAAA,KAAK,EAAA,KAAP;AAAS,MAAA,QAAQ,EAAlB;AAAC,KAAD;AAAqB,GADtB,EAExB,IAFwB,CAEnB,UAAC,EAAD,EAAK,EAAL,EAAO;AAAK,WAAA,EAAE,CAAC,KAAH,GAAW,EAAE,CAAb,KAAA;AAAmB,GAFZ,EAGxB,GAHwB,CAGpB,UAAA,CAAA,EAAC;AAAI,WAAA,CAAC,CAAD,QAAA;AAAU,GAHK,CAA3B;AAKA,MAAM,IAAI,GAAa,EAAvB;;;AAGE,QAAM,IAAI,GAAG,oBAAoB,CAAC,GAArB,EAAb;AACA,IAAA,IAAI,CAAC,IAAL,CAAU,IAAV;AAEA,QAAM,OAAO,GAAG,oBAAhB;AAEA,QAAM,OAAO,GAAa,EAA1B;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,OAAO,CAAC,MAA5B,EAAoC,CAAC,EAArC,EAAyC;AACvC,UAAM,GAAG,GAAG,OAAO,CAAC,CAAD,CAAnB;AAEA,UAAM,OAAO,GAAG,KAAK,CAAC,IAAD,CAArB;AACA,UAAM,MAAM,GAAG,KAAK,CAAC,GAAD,CAApB;AAEA,MAAA,OAAO,CAAC,IAAR,CAAa,GAAG,CAAC,OAAD,EAAU,MAAV,EAAkB,KAAlB,CAAhB;AACD;;AAED,IAAA,oBAAoB,GAAG,oBAAoB,CAAC,MAArB,CACrB,UAAC,CAAD,EAAI,CAAJ,EAAK;AAAK,aAAA,OAAO,CAAC,CAAD,CAAP,IAAA,YAAA;AAA0B,KADf,CAAvB;;;AAhBF,SAAM,oBAAoB,CAAC,MAArB,GAA8B,CAApC,EAAqC;;AAmBpC;;AAED,SAAO,IAAP;AAED","sourceRoot":"","sourcesContent":["import { iou } from './iou';\r\nexport function nonMaxSuppression(boxes, scores, iouThreshold, isIOU) {\r\n    if (isIOU === void 0) { isIOU = true; }\r\n    var indicesSortedByScore = scores\r\n        .map(function (score, boxIndex) { return ({ score: score, boxIndex: boxIndex }); })\r\n        .sort(function (c1, c2) { return c1.score - c2.score; })\r\n        .map(function (c) { return c.boxIndex; });\r\n    var pick = [];\r\n    var _loop_1 = function () {\r\n        var curr = indicesSortedByScore.pop();\r\n        pick.push(curr);\r\n        var indices = indicesSortedByScore;\r\n        var outputs = [];\r\n        for (var i = 0; i < indices.length; i++) {\r\n            var idx = indices[i];\r\n            var currBox = boxes[curr];\r\n            var idxBox = boxes[idx];\r\n            outputs.push(iou(currBox, idxBox, isIOU));\r\n        }\r\n        indicesSortedByScore = indicesSortedByScore.filter(function (_, j) { return outputs[j] <= iouThreshold; });\r\n    };\r\n    while (indicesSortedByScore.length > 0) {\r\n        _loop_1();\r\n    }\r\n    return pick;\r\n}\r\n//# sourceMappingURL=nonMaxSuppression.js.map"]},"metadata":{},"sourceType":"module"}